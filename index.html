<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ğŸƒâ€â™‚ï¸ Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡ Ø±Ø§Ù†Ø±</title>
<style>
  body {
    margin: 0;
    padding: 0;
    background: #fdfdfd;
    font-family: Tahoma, sans-serif;
    text-align: center;
    overflow: hidden;
  }
  h1 { margin: 10px; font-size: 20px; }
  #game {
    position: relative;
    width: 100%;
    height: 400px;
    background: linear-gradient(to top, #f4f4f4, #eaeaea);
    border-top: 4px solid #333;
    overflow: hidden;
  }
  .player {
    position: absolute;
    bottom: 20px;
    left: 40px;
    width: 40px;
    height: 40px;
    background: blue;
    border-radius: 8px;
  }
  .item {
    position: absolute;
    bottom: 20px;
    width: 35px;
    height: 35px;
    border-radius: 50%;
  }
  .coin { background: gold; }
  .obstacle { background: crimson; border-radius: 6px; }
  .boost { background: limegreen; border: 3px solid white; }
  #score {
    font-size: 18px;
    margin: 8px;
  }
  #final-screen {
    display:none;
    margin-top:20px;
  }
  .download-button {
    display:inline-block;
    padding:14px 28px;
    background:#28a745;
    color:#fff;
    text-decoration:none;
    border-radius:12px;
    font-weight:bold;
    font-size:18px;
  }
  button {
    padding:12px 20px;
    font-size:18px;
    margin: 10px;
    border:none;
    background:#007bff;
    color:#fff;
    border-radius:10px;
    cursor:pointer;
  }
</style>
</head>
<body>
  <h1>ğŸƒâ€â™‚ï¸ Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡ Ø±Ø§Ù†Ø± - Ø³ÙˆØ¯ Ø¬Ù…Ø¹ Ú©Ù†ØŒ Ø¶Ø±Ø± ÙØ±Ø§Ø± Ø¨Ø¯Ù‡!</h1>
  <p id="score">Ø§Ù…ØªÛŒØ§Ø²: 0</p>
  <div id="game">
    <div class="player" id="player"></div>
  </div>
  <button id="startBtn">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>

  <!-- Final Screen -->
  <div id="final-screen">
    <h2>ğŸ‰ ØªØ¨Ø±ÛŒÚ©!</h2>
    <p>Ø´Ù…Ø§ Ø¯Ú©Ø§Ù† Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø±Ø¯ÛŒØ¯ Ùˆ Ø¨Ù‡ Ø³ÙˆØ¯ Ø±Ø³ÛŒØ¯ÛŒØ¯.  
    Ø¯Ø± Ø¯Ù†ÛŒØ§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ù‡Ù… Ø¨Ø§ <b>Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡</b> Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ø±Ù†Ø¯Ù‡ Ø¨Ø§Ø´ÛŒØ¯!</p>
    <a href="https://mld10sar.github.io/Esmat/app-release.apk" class="download-button" download>ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„</a>
  </div>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const scoreDisplay = document.getElementById("score");
const startBtn = document.getElementById("startBtn");
const finalScreen = document.getElementById("final-screen");

let score = 0;
let gameInterval, itemInterval;
let isJumping = false;
let isInvincible = false;
let gameRunning = false;

function startGame() {
  score = 0;
  scoreDisplay.innerText = "Ø§Ù…ØªÛŒØ§Ø²: 0";
  finalScreen.style.display = "none";
  startBtn.style.display = "none";
  gameRunning = true;

  // Clear existing items
  document.querySelectorAll(".item").forEach(el => el.remove());

  gameInterval = setInterval(updateGame, 20);
  itemInterval = setInterval(spawnItem, 1500);

  document.addEventListener("keydown", jump);
  document.addEventListener("click", jump);
}

function endGame() {
  clearInterval(gameInterval);
  clearInterval(itemInterval);
  document.removeEventListener("keydown", jump);
  document.removeEventListener("click", jump);
  gameRunning = false;
  startBtn.style.display = "inline-block";
  game.style.display = "none";
  finalScreen.style.display = "block";
}

function jump(e) {
  if (isJumping || !gameRunning) return;
  isJumping = true;
  let pos = 20;
  const up = setInterval(() => {
    if (pos >= 120) {
      clearInterval(up);
      const down = setInterval(() => {
        if (pos <= 20) {
          clearInterval(down);
          isJumping = false;
        }
        pos -= 5;
        player.style.bottom = pos + "px";
      }, 20);
    }
    pos += 5;
    player.style.bottom = pos + "px";
  }, 20);
}

function spawnItem() {
  if (!gameRunning) return;
  const item = document.createElement("div");
  item.classList.add("item");

  // Random type
  const types = ["coin","obstacle","boost"];
  let type = types[Math.floor(Math.random()*types.length)];
  item.classList.add(type);

  let yPos = 20;
  if (type==="coin" || type==="boost") yPos = Math.random()>0.5?20:120;
  item.style.bottom = yPos+"px";
  item.style.right = "0px";
  game.appendChild(item);
}

function updateGame() {
  let items = document.querySelectorAll(".item");
  items.forEach(item => {
    let right = parseInt(item.style.right);
    if (isNaN(right)) right=0;
    item.style.right = (right+5) + "px";

    if (parseInt(item.style.right) > window.innerWidth) {
      item.remove();
      return;
    }

    // Collision detection
    let playerRect = player.getBoundingClientRect();
    let itemRect = item.getBoundingClientRect();

    if (!(playerRect.right < itemRect.left ||
          playerRect.left > itemRect.right ||
          playerRect.bottom < itemRect.top ||
          playerRect.top > itemRect.bottom)) {
      
      if (item.classList.contains("coin")) {
        score++;
        scoreDisplay.innerText = "Ø§Ù…ØªÛŒØ§Ø²: " + score;
        item.remove();
      }
      else if (item.classList.contains("boost")) {
        isInvincible = true;
        player.style.background = "limegreen";
        item.remove();
        setTimeout(()=>{
          isInvincible = false;
          player.style.background = "blue";
        },5000);
      }
      else if (item.classList.contains("obstacle")) {
        if (!isInvincible) {
          endGame();
        } else {
          item.remove();
        }
      }
    }
  });
}

startBtn.addEventListener("click", () => {
  game.style.display = "block";
  startGame();
});
</script>
</body>
</html>
