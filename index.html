<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ğŸƒâ€â™‚ï¸ Cash Flow Runner - Ø¨Ø§Ø²ÛŒ Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡</title>
<style>
  body {
    margin:0; padding:0;
    font-family: "Tahoma", sans-serif;
    overflow:hidden;
    background:#222;
  }
  #gameCanvas {
    display:block;
    margin:0 auto;
    background: linear-gradient(to top, #f2d16b 0%, #a1dffb 100%);
    border-bottom:6px solid #654321;
  }
  #hud {
    position:absolute; top:10px; left:10px;
    font-size:20px; font-weight:bold;
    background:rgba(0,0,0,0.6);
    padding:8px 16px; border-radius:12px;
    color:#fff; box-shadow:0 0 10px rgba(0,0,0,0.8);
  }
  #tutorial, #gameOver {
    position:absolute; top:0; left:0; right:0; bottom:0;
    background:rgba(0,0,0,0.8); color:#fff;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    text-align:center; padding:20px; z-index:10;
    animation: fadeIn 0.5s;
  }
  #tutorial button, #gameOver a {
    margin-top:20px; padding:12px 28px; font-size:18px;
    border:none; border-radius:12px; cursor:pointer;
    background:linear-gradient(45deg, #28a745, #45d672);
    color:#fff; text-decoration:none;
    transition: transform 0.2s;
  }
  #tutorial button:hover, #gameOver a:hover { transform:scale(1.1); }
  #controls {
    position:absolute; bottom:20px; left:50%; transform:translateX(-50%);
    display:flex; gap:20px; z-index:5;
  }
  #controls button {
    padding:18px 20px; font-size:22px;
    border:none; border-radius:50%; background:#007bff; color:#fff;
    cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.5);
    transition: transform 0.2s;
  }
  #controls button:active { transform:scale(0.9); }
  @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<div id="hud">Ø§Ù…ØªÛŒØ§Ø²: <span id="score">0</span></div>

<!-- Tutorial Screen -->
<div id="tutorial">
  <h2>ğŸª Ø¨Ø§Ø²ÛŒ Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡</h2>
  <p>ğŸ’° Ø¬Ù…Ø¹ Ø¢ÙˆØ±ÛŒ Ø³Ú©Ù‡ = <b>Ø³ÙˆØ¯</b></p>
  <p>âŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ù…Ø§Ù†Ø¹ = <b>Ø¶Ø±Ø±</b></p>
  <p>âš¡ Ú¯Ø±ÙØªÙ† Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡ = <b>Ù…Ø­Ø§ÙØ¸Øª Ûµ Ø«Ø§Ù†ÛŒÙ‡â€ŒØ§ÛŒ</b></p>
  <p>ÙØ±Ø§Ø± Ú©Ù† Ù‚Ø¨Ù„ Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ù…Ø§Ù…ÙˆØ± Ù…Ø§Ù„ÛŒØ§Øª Ø¨Ú¯ÛŒØ±Ø¯Øª!</p>
  <button onclick="startGame()">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
</div>

<!-- Game Over Screen -->
<div id="gameOver" style="display:none;">
  <h2>Ø¨Ø§Ø²ÛŒ ØªÙ…Ø§Ù… Ø´Ø¯ ğŸ˜¢</h2>
  <p>Ø§Ù…ØªÛŒØ§Ø² Ø´Ù…Ø§: <span id="finalScore"></span></p>
  <p>Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù‚Ø¹ÛŒ Ø¯Ú©Ø§Ù†ØªØŒ <b>Ø±ÙˆØ²Ù†Ø§Ù…Ú†Ù‡</b> Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†:</p>
  <a href="https://mld10sar.github.io/Esmat/app-release.apk" download>ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„</a>
</div>

<!-- Controls (for mobile) -->
<div id="controls">
  <button onclick="moveUp()">â¬†ï¸</button>
  <button onclick="moveDown()">â¬‡ï¸</button>
</div>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");

let gameInterval,bgX=0,score=0;
let gameRunning=false,boost=false,boostTimer=0;
let lanes=[150,300,450];
let player={x:60,y:lanes[1],lane:1,size:40,color:"blue"};
let obstacles=[],coins=[],boosts=[];
let taxCollectorX=-60;

function startGame(){
  document.getElementById("tutorial").style.display="none";
  document.getElementById("gameOver").style.display="none";
  gameRunning=true;
  score=0; obstacles=[]; coins=[]; boosts=[];
  taxCollectorX=-60; player.lane=1; player.y=lanes[1];
  boost=false;
  gameInterval=setInterval(update,1000/60);
}

function moveUp(){ if(player.lane>0){ player.lane--; player.y=lanes[player.lane]; } }
function moveDown(){ if(player.lane<2){ player.lane++; player.y=lanes[player.lane]; } }
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp") moveUp();
  if(e.key==="ArrowDown") moveDown();
});

function spawn(){
  if(Math.random()<0.04) obstacles.push({x:400,y:lanes[Math.floor(Math.random()*3)],size:40});
  if(Math.random()<0.06) coins.push({x:400,y:lanes[Math.floor(Math.random()*3)],size:25});
  if(Math.random()<0.01) boosts.push({x:400,y:lanes[Math.floor(Math.random()*3)],size:30});
}

function update(){
  ctx.clearRect(0,0,400,600);
  // Background gradient sky
  ctx.fillStyle="#a1dffb"; ctx.fillRect(0,0,400,600);
  ctx.fillStyle="#654321"; ctx.fillRect(0,550,400,50); // ground
  
  // Player
  ctx.fillStyle=boost?"gold":player.color;
  ctx.beginPath(); ctx.arc(player.x,player.y,player.size/2,0,Math.PI*2); ctx.fill();
  if(boost) ctx.shadowColor="gold",ctx.shadowBlur=20;
  else ctx.shadowBlur=0;

  // Tax collector
  ctx.fillStyle="darkred"; ctx.fillRect(taxCollectorX,0,50,600);
  taxCollectorX+=0.5;

  spawn();
  // Obstacles
  for(let i=obstacles.length-1;i>=0;i--){
    let o=obstacles[i]; o.x-=4;
    ctx.fillStyle="#333"; ctx.fillRect(o.x,o.y-20,o.size,o.size);
    if(o.x<0) obstacles.splice(i,1);
    if(collide(player,o)&&!boost){endGame(); return;}
  }
  // Coins
  for(let i=coins.length-1;i>=0;i--){
    let c=coins[i]; c.x-=4;
    ctx.fillStyle="yellow"; ctx.beginPath(); ctx.arc(c.x,c.y,12,0,Math.PI*2); ctx.fill();
    if(c.x<0) coins.splice(i,1);
    if(collide(player,c)){score+=10; coins.splice(i,1);}
  }
  // Boosts
  for(let i=boosts.length-1;i>=0;i--){
    let b=boosts[i]; b.x-=4;
    ctx.fillStyle="lime"; ctx.beginPath(); ctx.arc(b.x,b.y,15,0,Math.PI*2); ctx.fill();
    if(b.x<0) boosts.splice(i,1);
    if(collide(player,b)){boost=true; boostTimer=300; boosts.splice(i,1);}
  }
  if(boost){boostTimer--; if(boostTimer<=0) boost=false;}
  if(player.x<=taxCollectorX+50){endGame(); return;}
  score++; document.getElementById("score").textContent=score;
}

function collide(a,b){
  return Math.abs(a.x-b.x)<(a.size/2+b.size/2)&&Math.abs(a.y-b.y)<(a.size/2+b.size/2);
}
function endGame(){
  clearInterval(gameInterval); gameRunning=false;
  document.getElementById("finalScore").textContent=score;
  document.getElementById("gameOver").style.display="flex";
}
</script>
</body>
</html>
